# üéÆ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –¥–æ–Ω–∞—Ç-—Å–∏—Å—Ç–µ–º—ã —Å Garry's Mod

–ü–æ–ª–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—é –¥–æ–Ω–∞—Ç-—Å–∏—Å—Ç–µ–º—ã –∫ –≤–∞—à–µ–º—É —Å–µ—Ä–≤–µ—Ä—É Garry's Mod.

---

## üìã –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

1. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-—Å–∏—Å—Ç–µ–º—ã)
2. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ YooKassa](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-yookassa)
3. [API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã](#api-—ç–Ω–¥–ø–æ–∏–Ω—Ç—ã)
4. [–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ GLua](#–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è-–≤-glua)
5. [–ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞](#–ø—Ä–∏–º–µ—Ä—ã-–∫–æ–¥–∞)
6. [–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](#—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

```
–ò–≥—Ä–æ–∫ –≤ –∏–≥—Ä–µ ‚Üí GLua –º–µ–Ω—é ‚Üí URL —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ ‚Üí –°–∞–π—Ç ‚Üí YooKassa ‚Üí Webhook ‚Üí –ë–î ‚Üí GLua –ø–æ–ª—É—á–∞–µ—Ç –±–∞–ª–∞–Ω—Å
```

### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. **–ò–≥—Ä–æ–∫ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –¥–æ–Ω–∞—Ç-–º–µ–Ω—é** –≤ –∏–≥—Ä–µ (F4/!donate)
2. **–í–≤–æ–¥–∏—Ç —Å—É–º–º—É** –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è (–º–∏–Ω–∏–º—É–º 100 —Ä—É–±–ª–µ–π)
3. **–ò–≥—Ä–∞ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –±—Ä–∞—É–∑–µ—Ä** —Å URL: `https://abyssal-scp-project.poehali.dev/donate?steam_id=76561198000000001&amount=500`
4. **–°–∞–π—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç** Steam ID –∏ —Å—É–º–º—É
5. **–ò–≥—Ä–æ–∫ –Ω–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É** "–ü–µ—Ä–µ–π—Ç–∏ –∫ –æ–ø–ª–∞—Ç–µ"
6. **–ÆKassa –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç** –ø–ª–∞—Ç–µ–∂
7. **Webhook –∑–∞—á–∏—Å–ª—è–µ—Ç** –¥–æ–Ω–∞—Ç-–≤–∞–ª—é—Ç—É –≤ –ë–î
8. **GLua –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –±–∞–ª–∞–Ω—Å** —á–µ—Ä–µ–∑ API

---

## üí≥ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ YooKassa

### 1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è

1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ https://yookassa.ru
2. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–µ –ª–∏—Ü–æ (–ò–ü –∏–ª–∏ —Å–∞–º–æ–∑–∞–Ω—è—Ç—ã–π)
3. –î–æ–∂–¥–∏—Ç–µ—Å—å –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –∞–∫–∫–∞—É–Ω—Ç–∞

### 2. –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–ª—é—á–µ–π

**Shop ID:**
- –û—Ç–∫—Ä–æ–π—Ç–µ https://yookassa.ru/my/payments
- –í —à–∞–ø–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —É–≤–∏–¥–∏—Ç–µ `shopId` (–Ω–∞–ø—Ä–∏–º–µ—Ä: `123456`)

**Secret Key:**
- –û—Ç–∫—Ä–æ–π—Ç–µ https://yookassa.ru/my/merchant/integration/api-keys
- –ù–∞–∂–º–∏—Ç–µ "–°–æ–∑–¥–∞—Ç—å –∫–ª—é—á"
- –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á (–Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `live_`)

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Webhook

**‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û:**

1. –û—Ç–∫—Ä–æ–π—Ç–µ https://yookassa.ru/my/merchant/integration/http-notifications
2. –î–æ–±–∞–≤—å—Ç–µ URL webhook: `https://functions.poehali.dev/80327d36-1166-490c-94ee-5bd1216b7716`
3. **–û—Ç–º–µ—Ç—å—Ç–µ –í–°–ï —á–µ–∫–±–æ–∫—Å—ã:**
   - ‚úÖ `payment.succeeded` ‚Äî —É—Å–ø–µ—à–Ω—ã–π –ø–ª–∞—Ç—ë–∂
   - ‚úÖ `payment.waiting_for_capture` ‚Äî –æ–∂–∏–¥–∞–Ω–∏–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
   - ‚úÖ `payment.canceled` ‚Äî –æ—Ç–º–µ–Ω–∞ –ø–ª–∞—Ç–µ–∂–∞
   - ‚úÖ `refund.succeeded` ‚Äî —É—Å–ø–µ—à–Ω—ã–π –≤–æ–∑–≤—Ä–∞—Ç

**–ë–µ–∑ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ webhook –±–∞–ª–∞–Ω—Å –ù–ï –±—É–¥–µ—Ç –∑–∞—á–∏—Å–ª—è—Ç—å—Å—è!**

### 4. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–æ–≤ –≤ –ø—Ä–æ–µ–∫—Ç

–í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ poehali.dev –¥–æ–±–∞–≤—å—Ç–µ:
- `YOOKASSA_SHOP_ID` ‚Äî –≤–∞—à Shop ID
- `YOOKASSA_SECRET_KEY` ‚Äî —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á API

---

## üîå API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞

**POST** `https://functions.poehali.dev/5af93bd2-a1ec-4d87-af66-f2bc997d7791`

```json
{
  "steam_id": "76561198000000001",
  "amount": 500,
  "return_url": "https://abyssal-scp-project.poehali.dev/donate?success=true"
}
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "payment_url": "https://yoomoney.ru/checkout/payments/v2/...",
  "payment_id": "2d8c5d31-000f-5000-a000-1f6c36c8e9e7",
  "order_id": 123,
  "order_number": "DONATE-20250107-A1B2C3D4"
}
```

**–í–∞–ª–∏–¥–∞—Ü–∏—è:**
- `steam_id`: —Ñ–æ—Ä–º–∞—Ç Steam ID64 (`765\d{14}`)
- `amount`: –æ—Ç 100 –¥–æ 100 000 —Ä—É–±–ª–µ–π
- `return_url`: –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `/donate`)

---

### 2. –ü–æ–ª—É—á–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –∏–≥—Ä–æ–∫–∞

**GET** `https://functions.poehali.dev/1b8eeb2b-1f5a-4296-90cf-5737f596b55f?steam_id=76561198000000001`

**–û—Ç–≤–µ—Ç:**
```json
{
  "steam_id": "76561198000000001",
  "balance": 1500,
  "total_donated": 3000,
  "exists": true,
  "created_at": "2025-01-07T12:00:00",
  "updated_at": "2025-01-07T13:30:00"
}
```

**–ï—Å–ª–∏ –∏–≥—Ä–æ–∫–∞ –Ω–µ—Ç –≤ –ë–î:**
```json
{
  "steam_id": "76561198000000001",
  "balance": 0,
  "total_donated": 0,
  "exists": false
}
```

---

### 3. Webhook (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)

**POST** `https://functions.poehali.dev/80327d36-1166-490c-94ee-5bd1216b7716`

–≠—Ç–æ—Ç —ç–Ω–¥–ø–æ–∏–Ω—Ç –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è YooKassa –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–∞ –ø–ª–∞—Ç–µ–∂–∞.

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç webhook:**
1. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–ª–∞—Ç–µ–∂ —á–µ—Ä–µ–∑ YooKassa API
2. –û–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞ –≤ –ë–î
3. –ó–∞—á–∏—Å–ª—è–µ—Ç –¥–æ–Ω–∞—Ç-–≤–∞–ª—é—Ç—É –∏–≥—Ä–æ–∫—É (1‚ÇΩ = 1 –¥–æ–Ω–∞—Ç-–≤–∞–ª—é—Ç–∞)
4. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç–∞—Ç—É—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏

---

## üéÆ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ GLua

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
garrysmod/
‚îî‚îÄ‚îÄ addons/
    ‚îî‚îÄ‚îÄ your_donation/
        ‚îî‚îÄ‚îÄ lua/
            ‚îú‚îÄ‚îÄ autorun/
            ‚îÇ   ‚îî‚îÄ‚îÄ donation_init.lua          # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
            ‚îú‚îÄ‚îÄ donation/
            ‚îÇ   ‚îú‚îÄ‚îÄ cl_menu.lua               # –ö–ª–∏–µ–Ω—Ç—Å–∫–æ–µ –º–µ–Ω—é
            ‚îÇ   ‚îú‚îÄ‚îÄ sv_api.lua                # –°–µ—Ä–≤–µ—Ä–Ω—ã–π API
            ‚îÇ   ‚îî‚îÄ‚îÄ sh_config.lua             # –û–±—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
            ‚îî‚îÄ‚îÄ vgui/
                ‚îî‚îÄ‚îÄ donation_panel.lua        # VGUI —ç–ª–µ–º–µ–Ω—Ç—ã
```

---

### 1. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (`sh_config.lua`)

```lua
DONATION = DONATION or {}

-- API endpoints
DONATION.Config = {
    CreatePaymentURL = "https://functions.poehali.dev/5af93bd2-a1ec-4d87-af66-f2bc997d7791",
    GetBalanceURL = "https://functions.poehali.dev/1b8eeb2b-1f5a-4296-90cf-5737f596b55f",
    WebsiteURL = "https://abyssal-scp-project.poehali.dev/donate",
    
    -- –ù–∞—Å—Ç—Ä–æ–π–∫–∏
    MinAmount = 100,
    MaxAmount = 100000,
    UpdateInterval = 60, -- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –∫–∞–∂–¥—ã–µ 60 —Å–µ–∫—É–Ω–¥
}

print("[DONATION] Config loaded!")
```

---

### 2. –°–µ—Ä–≤–µ—Ä–Ω—ã–π API (`sv_api.lua`)

```lua
if SERVER then
    util.AddNetworkString("Donation_OpenMenu")
    util.AddNetworkString("Donation_GetBalance")
    util.AddNetworkString("Donation_UpdateBalance")
    util.AddNetworkString("Donation_CreatePayment")

    -- –ö—ç—à –±–∞–ª–∞–Ω—Å–æ–≤ –∏–≥—Ä–æ–∫–æ–≤ (—á—Ç–æ–±—ã –Ω–µ —Å–ø–∞–º–∏—Ç—å API)
    DONATION.PlayerBalances = DONATION.PlayerBalances or {}
    DONATION.LastUpdate = DONATION.LastUpdate or {}

    -- –ü–æ–ª—É—á–∏—Ç—å –±–∞–ª–∞–Ω—Å –∏–≥—Ä–æ–∫–∞
    function DONATION.GetPlayerBalance(ply, callback)
        local steamid64 = ply:SteamID64()
        local now = CurTime()
        
        -- –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫—ç—à (–æ–±–Ω–æ–≤–ª—è–µ–º —Ä–∞–∑ –≤ –º–∏–Ω—É—Ç—É)
        if DONATION.LastUpdate[steamid64] and (now - DONATION.LastUpdate[steamid64]) < DONATION.Config.UpdateInterval then
            if callback then
                callback(DONATION.PlayerBalances[steamid64] or 0)
            end
            return
        end
        
        -- –ó–∞–ø—Ä–æ—Å –∫ API
        local url = DONATION.Config.GetBalanceURL .. "?steam_id=" .. steamid64
        
        HTTP({
            method = "GET",
            url = url,
            success = function(code, body, headers)
                if code == 200 then
                    local data = util.JSONToTable(body)
                    if data and data.balance then
                        DONATION.PlayerBalances[steamid64] = data.balance
                        DONATION.LastUpdate[steamid64] = now
                        
                        if callback then
                            callback(data.balance)
                        end
                        
                        -- –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∫–ª–∏–µ–Ω—Ç—É
                        net.Start("Donation_UpdateBalance")
                        net.WriteInt(data.balance, 32)
                        net.Send(ply)
                        
                        print("[DONATION] Balance for " .. ply:Nick() .. ": " .. data.balance)
                    end
                else
                    print("[DONATION] API error: " .. code)
                    if callback then callback(0) end
                end
            end,
            failed = function(err)
                print("[DONATION] Request failed: " .. err)
                if callback then callback(0) end
            end
        })
    end

    -- –ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –º–µ–Ω—é
    concommand.Add("donate", function(ply, cmd, args)
        DONATION.GetPlayerBalance(ply, function(balance)
            net.Start("Donation_OpenMenu")
            net.WriteInt(balance, 32)
            net.Send(ply)
        end)
    end)

    -- –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø–ª–∞—Ç–µ–∂–∞
    net.Receive("Donation_CreatePayment", function(len, ply)
        local amount = net.ReadInt(32)
        local steamid64 = ply:SteamID64()
        
        if amount < DONATION.Config.MinAmount or amount > DONATION.Config.MaxAmount then
            ply:ChatPrint("[–î–û–ù–ê–¢] –ù–µ–≤–µ—Ä–Ω–∞—è —Å—É–º–º–∞! –ú–∏–Ω–∏–º—É–º " .. DONATION.Config.MinAmount .. " ‚ÇΩ")
            return
        end
        
        -- –û—Ç–∫—Ä—ã–≤–∞–µ–º –±—Ä–∞—É–∑–µ—Ä —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
        local url = string.format(
            "%s?steam_id=%s&amount=%d",
            DONATION.Config.WebsiteURL,
            steamid64,
            amount
        )
        
        ply:SendLua([[gui.OpenURL("]] .. url .. [[")]])
        ply:ChatPrint("[–î–û–ù–ê–¢] –û—Ç–∫—Ä—ã–≤–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –æ–ø–ª–∞—Ç—ã...")
    end)

    -- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –ø—Ä–∏ –≤—Ö–æ–¥–µ
    hook.Add("PlayerInitialSpawn", "DONATION_PlayerSpawn", function(ply)
        timer.Simple(5, function()
            if IsValid(ply) then
                DONATION.GetPlayerBalance(ply)
            end
        end)
    end)

    -- –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–æ–≤ –æ–Ω–ª–∞–π–Ω –∏–≥—Ä–æ–∫–æ–≤
    timer.Create("DONATION_UpdateBalances", 120, 0, function()
        for _, ply in pairs(player.GetAll()) do
            DONATION.GetPlayerBalance(ply)
        end
    end)

    print("[DONATION] Server API loaded!")
end
```

---

### 3. –ö–ª–∏–µ–Ω—Ç—Å–∫–æ–µ –º–µ–Ω—é (`cl_menu.lua`)

```lua
if CLIENT then
    -- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
    DONATION.CurrentBalance = 0

    -- –ü–æ–ª—É—á–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞
    net.Receive("Donation_UpdateBalance", function()
        DONATION.CurrentBalance = net.ReadInt(32)
    end)

    -- –û—Ç–∫—Ä—ã—Ç–∏–µ –º–µ–Ω—é –¥–æ–Ω–∞—Ç–∞
    net.Receive("Donation_OpenMenu", function()
        local balance = net.ReadInt(32)
        DONATION.CurrentBalance = balance
        
        DONATION.OpenMenu()
    end)

    -- –°–æ–∑–¥–∞–Ω–∏–µ VGUI –º–µ–Ω—é
    function DONATION.OpenMenu()
        -- –ó–∞–∫—Ä—ã–≤–∞–µ–º —Å—Ç–∞—Ä–æ–µ –º–µ–Ω—é –µ—Å–ª–∏ –æ–Ω–æ –µ—Å—Ç—å
        if IsValid(DONATION.Frame) then
            DONATION.Frame:Remove()
        end
        
        -- –°–æ–∑–¥–∞–µ–º –≥–ª–∞–≤–Ω–æ–µ –æ–∫–Ω–æ
        local frame = vgui.Create("DFrame")
        frame:SetSize(600, 500)
        frame:Center()
        frame:SetTitle("–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–æ–Ω–∞—Ç-–±–∞–ª–∞–Ω—Å–∞")
        frame:SetVisible(true)
        frame:SetDraggable(true)
        frame:ShowCloseButton(true)
        frame:MakePopup()
        DONATION.Frame = frame
        
        -- –ë–∞–ª–∞–Ω—Å
        local balanceLabel = vgui.Create("DLabel", frame)
        balanceLabel:SetPos(20, 40)
        balanceLabel:SetSize(560, 30)
        balanceLabel:SetFont("DermaLarge")
        balanceLabel:SetText("–í–∞—à –±–∞–ª–∞–Ω—Å: " .. DONATION.CurrentBalance .. " –¥–æ–Ω–∞—Ç-–≤–∞–ª—é—Ç—ã")
        balanceLabel:SetTextColor(Color(255, 255, 255))
        
        -- Steam ID
        local steamLabel = vgui.Create("DLabel", frame)
        steamLabel:SetPos(20, 80)
        steamLabel:SetSize(560, 20)
        steamLabel:SetText("Steam ID: " .. LocalPlayer():SteamID64())
        
        -- –°—É–º–º–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è
        local amountLabel = vgui.Create("DLabel", frame)
        amountLabel:SetPos(20, 120)
        amountLabel:SetSize(560, 20)
        amountLabel:SetText("–°—É–º–º–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è (‚ÇΩ):")
        
        local amountEntry = vgui.Create("DTextEntry", frame)
        amountEntry:SetPos(20, 145)
        amountEntry:SetSize(560, 35)
        amountEntry:SetPlaceholderText("–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É (–º–∏–Ω–∏–º—É–º 100 ‚ÇΩ)")
        amountEntry:SetNumeric(true)
        
        -- –ë—ã—Å—Ç—Ä—ã–µ –∫–Ω–æ–ø–∫–∏
        local quickAmounts = {100, 500, 1000, 2000, 5000}
        local btnWidth = 106
        local btnHeight = 40
        local startX = 20
        local startY = 195
        
        for i, amount in ipairs(quickAmounts) do
            local btn = vgui.Create("DButton", frame)
            btn:SetPos(startX + (i - 1) * (btnWidth + 8), startY)
            btn:SetSize(btnWidth, btnHeight)
            btn:SetText(amount .. " ‚ÇΩ")
            btn.DoClick = function()
                amountEntry:SetText(tostring(amount))
            end
        end
        
        -- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
        local infoLabel = vgui.Create("DLabel", frame)
        infoLabel:SetPos(20, 250)
        infoLabel:SetSize(560, 100)
        infoLabel:SetText([[
–ö—É—Ä—Å –æ–±–º–µ–Ω–∞: 1‚ÇΩ = 1 –¥–æ–Ω–∞—Ç-–≤–∞–ª—é—Ç–∞
–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞: 100 ‚ÇΩ
–ü–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–∫–∏ –æ—Ç–∫—Ä–æ–µ—Ç—Å—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –æ–ø–ª–∞—Ç—ã.
–ë–∞–ª–∞–Ω—Å –±—É–¥–µ—Ç –∑–∞—á–∏—Å–ª–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç—ã.
        ]])
        infoLabel:SetWrap(true)
        infoLabel:SetAutoStretchVertical(true)
        
        -- –ö–Ω–æ–ø–∫–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è
        local payButton = vgui.Create("DButton", frame)
        payButton:SetPos(20, 380)
        payButton:SetSize(560, 60)
        payButton:SetText("–ü–ï–†–ï–ô–¢–ò –ö –û–ü–õ–ê–¢–ï")
        payButton:SetFont("DermaLarge")
        payButton.DoClick = function()
            local amount = tonumber(amountEntry:GetValue())
            
            if not amount or amount < DONATION.Config.MinAmount then
                chat.AddText(Color(255, 100, 100), "[–î–û–ù–ê–¢] ", Color(255, 255, 255), 
                    "–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è: " .. DONATION.Config.MinAmount .. " ‚ÇΩ")
                surface.PlaySound("buttons/button10.wav")
                return
            end
            
            if amount > DONATION.Config.MaxAmount then
                chat.AddText(Color(255, 100, 100), "[–î–û–ù–ê–¢] ", Color(255, 255, 255), 
                    "–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è: " .. DONATION.Config.MaxAmount .. " ‚ÇΩ")
                surface.PlaySound("buttons/button10.wav")
                return
            end
            
            -- –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä
            net.Start("Donation_CreatePayment")
            net.WriteInt(amount, 32)
            net.SendToServer()
            
            chat.AddText(Color(100, 255, 100), "[–î–û–ù–ê–¢] ", Color(255, 255, 255), 
                "–û—Ç–∫—Ä—ã–≤–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –æ–ø–ª–∞—Ç—ã...")
            surface.PlaySound("buttons/button15.wav")
            
            frame:Close()
        end
        
        -- –ö–Ω–æ–ø–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞
        local refreshButton = vgui.Create("DButton", frame)
        refreshButton:SetPos(20, 450)
        refreshButton:SetSize(560, 30)
        refreshButton:SetText("–û–±–Ω–æ–≤–∏—Ç—å –±–∞–ª–∞–Ω—Å")
        refreshButton.DoClick = function()
            RunConsoleCommand("donate")
            chat.AddText(Color(100, 255, 100), "[–î–û–ù–ê–¢] ", Color(255, 255, 255), "–û–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å...")
        end
    end

    -- –ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –º–µ–Ω—é
    concommand.Add("donate_menu", function()
        RunConsoleCommand("donate")
    end)

    print("[DONATION] Client menu loaded!")
end
```

---

### 4. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è (`autorun/donation_init.lua`)

```lua
-- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –¥–æ–Ω–∞—Ç–æ–≤
DONATION = DONATION or {}

if SERVER then
    AddCSLuaFile("donation/sh_config.lua")
    AddCSLuaFile("donation/cl_menu.lua")
    
    include("donation/sh_config.lua")
    include("donation/sv_api.lua")
    
    print("[DONATION] Server-side loaded!")
else
    include("donation/sh_config.lua")
    include("donation/cl_menu.lua")
    
    print("[DONATION] Client-side loaded!")
end
```

---

## üéØ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –û—Ç–∫—Ä—ã—Ç–∏–µ –º–µ–Ω—é –¥–æ–Ω–∞—Ç–∞

**–ß–µ—Ä–µ–∑ –∫–æ–Ω—Å–æ–ª—å:**
```
donate
```

**–ß–µ—Ä–µ–∑ —á–∞—Ç:**
```lua
hook.Add("PlayerSay", "DONATION_ChatCommand", function(ply, text)
    if string.lower(text) == "!donate" or string.lower(text) == "!–¥–æ–Ω–∞—Ç" then
        ply:ConCommand("donate")
        return ""
    end
end)
```

**–ß–µ—Ä–µ–∑ F4 –º–µ–Ω—é (DarkRP):**
```lua
-- –í DarkRP F4 –º–µ–Ω—é –¥–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É:
local donateButton = vgui.Create("DButton", panel)
donateButton:SetText("üí∞ –ü–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å")
donateButton.DoClick = function()
    RunConsoleCommand("donate")
end
```

---

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞ –∏–≥—Ä–æ–∫–∞ (—Å–µ—Ä–≤–µ—Ä–Ω–∞—è)

```lua
-- –ü–æ–ª—É—á–∏—Ç—å –±–∞–ª–∞–Ω—Å –∏–≥—Ä–æ–∫–∞
DONATION.GetPlayerBalance(ply, function(balance)
    print("–ë–∞–ª–∞–Ω—Å –∏–≥—Ä–æ–∫–∞ " .. ply:Nick() .. ": " .. balance)
    
    -- –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ VIP
    if balance >= 1000 then
        ply:SetUserGroup("vip")
    end
end)
```

---

### –°–ø–∏—Å–∞–Ω–∏–µ –¥–æ–Ω–∞—Ç-–≤–∞–ª—é—Ç—ã

```lua
-- –§—É–Ω–∫—Ü–∏—è —Å–ø–∏—Å–∞–Ω–∏—è
function DONATION.TakeBalance(ply, amount, reason, callback)
    DONATION.GetPlayerBalance(ply, function(current_balance)
        if current_balance >= amount then
            -- –ó–¥–µ—Å—å –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –≤ backend –¥–ª—è —Å–ø–∏—Å–∞–Ω–∏—è
            -- –ü–æ–∫–∞ —á—Ç–æ –æ–±–Ω–æ–≤–ª—è–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–π –∫—ç—à
            DONATION.PlayerBalances[ply:SteamID64()] = current_balance - amount
            
            ply:ChatPrint("[–î–û–ù–ê–¢] –°–ø–∏—Å–∞–Ω–æ " .. amount .. " –¥–æ–Ω–∞—Ç-–≤–∞–ª—é—Ç—ã. –ü—Ä–∏—á–∏–Ω–∞: " .. reason)
            
            if callback then callback(true) end
        else
            ply:ChatPrint("[–î–û–ù–ê–¢] –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤! –ù—É–∂–Ω–æ: " .. amount .. ", –µ—Å—Ç—å: " .. current_balance)
            if callback then callback(false) end
        end
    end)
end

-- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
DONATION.TakeBalance(ply, 500, "–ü–æ–∫—É–ø–∫–∞ VIP —Å—Ç–∞—Ç—É—Å–∞", function(success)
    if success then
        ply:SetUserGroup("vip")
        ply:ChatPrint("[VIP] –í—ã –ø–æ–ª—É—á–∏–ª–∏ VIP —Å—Ç–∞—Ç—É—Å!")
    end
end)
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 1. –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º YooKassa

–í –∫–∞–±–∏–Ω–µ—Ç–µ YooKassa –≤–∫–ª—é—á–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º:
1. https://yookassa.ru/my/merchant/integration/settings
2. –í–∫–ª—é—á–∏—Ç—å "–¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º"

**–¢–µ—Å—Ç–æ–≤—ã–µ –∫–∞—Ä—Ç—ã:**
- `5555 5555 5555 4477` ‚Äî —É—Å–ø–µ—à–Ω–∞—è –æ–ø–ª–∞—Ç–∞
- `5555 5555 5555 4444` ‚Äî –æ—Ç–∫–ª–æ–Ω–µ–Ω–Ω–∞—è –æ–ø–ª–∞—Ç–∞
- CVC: –ª—é–±—ã–µ 3 —Ü–∏—Ñ—Ä—ã
- –°—Ä–æ–∫: –ª—é–±–∞—è –±—É–¥—É—â–∞—è –¥–∞—Ç–∞

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ –∫–æ–Ω—Å–æ–ª—å GMod

```lua
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
lua_run_cl PrintTable(DONATION.Config)

-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–∞–ª–∞–Ω—Å
lua_run DONATION.GetPlayerBalance(player.GetByID(1), function(b) print("Balance:", b) end)

-- –û—Ç–∫—Ä—ã—Ç—å –º–µ–Ω—é
donate
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ API –≤—Ä—É—á–Ω—É—é

**PowerShell:**
```powershell
# –ü–æ–ª—É—á–∏—Ç—å –±–∞–ª–∞–Ω—Å
$steamId = "76561198000000001"
$response = Invoke-RestMethod -Uri "https://functions.poehali.dev/1b8eeb2b-1f5a-4296-90cf-5737f596b55f?steam_id=$steamId"
$response | ConvertTo-Json
```

**curl:**
```bash
# –ü–æ–ª—É—á–∏—Ç—å –±–∞–ª–∞–Ω—Å
curl "https://functions.poehali.dev/1b8eeb2b-1f5a-4296-90cf-5737f596b55f?steam_id=76561198000000001"

# –°–æ–∑–¥–∞—Ç—å –ø–ª–∞—Ç–µ–∂
curl -X POST "https://functions.poehali.dev/5af93bd2-a1ec-4d87-af66-f2bc997d7791" \
  -H "Content-Type: application/json" \
  -d '{"steam_id":"76561198000000001","amount":500}'
```

---

## ‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –ë–∞–ª–∞–Ω—Å –Ω–µ –∑–∞—á–∏—Å–ª—è–µ—Ç—Å—è

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω webhook –≤ YooKassa

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ https://yookassa.ru/my/merchant/integration/http-notifications
2. URL –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å: `https://functions.poehali.dev/80327d36-1166-490c-94ee-5bd1216b7716`
3. –í—Å–µ —Å–æ–±—ã—Ç–∏—è –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ—Ç–º–µ—á–µ–Ω—ã –≥–∞–ª–æ—á–∫–∞–º–∏

---

### –û—à–∏–±–∫–∞ "Payment system not configured"

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã —Å–µ–∫—Ä–µ—Ç—ã YOOKASSA_SHOP_ID –∏ YOOKASSA_SECRET_KEY

**–†–µ—à–µ–Ω–∏–µ:**
–î–æ–±–∞–≤—å—Ç–µ —Å–µ–∫—Ä–µ—Ç—ã –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ poehali.dev

---

### –ò–≥—Ä–æ–∫ –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –ø—Ä–∏ –æ–ø–ª–∞—Ç–µ

**–ü—Ä–∏—á–∏–Ω–∞:** –°–∏—Å—Ç–µ–º–∞ –ø–æ–∫–∞ –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –æ–Ω–ª–∞–π–Ω —Å—Ç–∞—Ç—É—Å

**–†–µ—à–µ–Ω–∏–µ:**
–ë–∞–ª–∞–Ω—Å –∑–∞—á–∏—Å–ª—è–µ—Ç—Å—è –≤ –ª—é–±–æ–º —Å–ª—É—á–∞–µ. –ü—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –≤—Ö–æ–¥–µ –∏–≥—Ä–æ–∫ –ø–æ–ª—É—á–∏—Ç —Å–≤–æ–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞. –ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ–Ω–ª–∞–π–Ω–∞, –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ –±—É–¥—É—â–µ–º.

---

### –ë—Ä–∞—É–∑–µ—Ä –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è

**–ü—Ä–∏—á–∏–Ω–∞:** –£ –∏–≥—Ä–æ–∫–∞ –æ—Ç–∫–ª—é—á–µ–Ω—ã HTML-–ø–∞–Ω–µ–ª–∏ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö GMod

**–†–µ—à–µ–Ω–∏–µ:**
–ü–æ–ø—Ä–æ—Å–∏—Ç–µ –∏–≥—Ä–æ–∫–∞ –≤–∫–ª—é—á–∏—Ç—å HTML-–ø–∞–Ω–µ–ª–∏ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –∏–≥—Ä—ã –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–±:
```lua
-- –í–º–µ—Å—Ç–æ gui.OpenURL –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –±—É—Ñ–µ—Ä
SetClipboardText(url)
ply:ChatPrint("[–î–û–ù–ê–¢] –°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞! –í—Å—Ç–∞–≤—å—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä.")
```

---

## üìä –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü–∞ players

| –ö–æ–ª–æ–Ω–∫–∞ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|-----|----------|
| `id` | SERIAL | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID |
| `steam_id` | VARCHAR(255) | Steam ID64 –∏–≥—Ä–æ–∫–∞ |
| `balance` | INTEGER | –¢–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å |
| `total_donated` | INTEGER | –í—Å–µ–≥–æ –ø–æ–ø–æ–ª–Ω–µ–Ω–æ –∑–∞ –≤—Å–µ –≤—Ä–µ–º—è |
| `last_online` | TIMESTAMP | –ü–æ—Å–ª–µ–¥–Ω–∏–π –≤—Ö–æ–¥ |
| `created_at` | TIMESTAMP | –î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ |
| `updated_at` | TIMESTAMP | –ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ |

### –¢–∞–±–ª–∏—Ü–∞ orders

| –ö–æ–ª–æ–Ω–∫–∞ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|-----|----------|
| `id` | SERIAL | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –∑–∞–∫–∞–∑–∞ |
| `order_number` | VARCHAR(50) | –ù–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞ (DONATE-...) |
| `steam_id` | VARCHAR(255) | Steam ID64 –∏–≥—Ä–æ–∫–∞ |
| `amount` | DECIMAL(10,2) | –°—É–º–º–∞ –ø–ª–∞—Ç–µ–∂–∞ |
| `yookassa_payment_id` | VARCHAR(100) | ID –ø–ª–∞—Ç–µ–∂–∞ –≤ YooKassa |
| `status` | VARCHAR(20) | pending/paid/canceled |
| `payment_url` | TEXT | –°—Å—ã–ª–∫–∞ –Ω–∞ –æ–ø–ª–∞—Ç—É |
| `created_at` | TIMESTAMP | –°–æ–∑–¥–∞–Ω |
| `paid_at` | TIMESTAMP | –û–ø–ª–∞—á–µ–Ω |

---

## üéâ –ì–æ—Ç–æ–≤–æ!

–¢–µ–ø–µ—Ä—å —É –≤–∞—Å –µ—Å—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—á–∞—è –¥–æ–Ω–∞—Ç-—Å–∏—Å—Ç–µ–º–∞:

‚úÖ –ò–≥—Ä–æ–∫–∏ –º–æ–≥—É—Ç –ø–æ–ø–æ–ª–Ω—è—Ç—å –±–∞–ª–∞–Ω—Å –ø—Ä—è–º–æ –∏–∑ –∏–≥—Ä—ã  
‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞—á–∏—Å–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ webhook  
‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏ —á–µ—Ä–µ–∑ –ÆKassa  
‚úÖ –ö—É—Ä—Å 1‚ÇΩ = 1 –¥–æ–Ω–∞—Ç-–≤–∞–ª—é—Ç–∞  
‚úÖ –ú–∏–Ω–∏–º—É–º –∫–æ–¥ ‚Äî –º–∞–∫—Å–∏–º—É–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞  

**–ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å?** –ü–∏—à–∏ –≤ Discord: https://discord.gg/jXuuBA9GXr
